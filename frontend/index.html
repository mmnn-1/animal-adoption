<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>æµæµªå‹•ç‰©æ”¶é¤Šå¹³å°</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #ef844093;
    }

    nav {
      background-color: #ff8c42;
      padding: 15px 0;
      text-align: left;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    nav ul {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    nav ul li {
      display: inline-block;
      margin: 0 15px;
    }

    nav ul li a {
      text-decoration: none;
      color: white;
      font-weight: bold;
      padding: 10px 20px;
      border-radius: 5px;
      background-color: rgba(255, 255, 255, 0.1);
      transition: background-color 0.3s;
    }

    nav ul li a:hover {
      background-color: rgba(255, 255, 255, 0.3);
    }

    h1 {
      text-align: center;
      margin-top: 30px;
      color: #333;
    }

    #animal-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 20px;
    }

    .animal-card {
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 15px;
      margin: 15px;
      width: 220px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }

    .animal-card:hover {
      transform: translateY(-5px);
    }

    .animal-card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 8px;
    }

    button {
      margin-top: 10px;
      background-color: #ff8c42;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #e6722c;
    }
     #news-section {
      padding: 30px 20px;
    }

    .scroll-container {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding: 10px 0;
      scroll-snap-type: x mandatory;
    }

    .scroll-container::-webkit-scrollbar {
      height: 8px;
    }

    .scroll-container::-webkit-scrollbar-thumb {
      background: #ff8c42;
      border-radius: 5px;
    }

    .news-card {
      min-width: 250px;
      flex-shrink: 0;
      background-color: #fff;
      border-radius: 10px;
      padding: 20px;
      scroll-snap-align: start;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }

    .news-card:hover {
      transform: scale(1.03);
    }
    .marquee-container{
      width:100%;
      overflow:hidden;
      background-color: #fff8f4;
      padding: 10px 0;
    }
    .marquee{
      display: inline-block;
      white-space: nowrap;
      color:#d35400;
      font-weight: bold;
      font-size: 18px;
      animation: scroll-left 15s linear infinite;
    }
    @keyframes scroll-left{
      0%{
        transform: translateX(100%);
      }
      100% {
    transform: translateX(-100%);
  }
    }
  </style>
</head>
<body>
  <!-- å°è¦½åˆ— -->
  <nav>
    <ul>
      <li><a href="#" onclick="toggleNews()">æœ€æ–°æ¶ˆæ¯</a></li>
      <li><a href="#">é—œæ–¼æˆ‘å€‘</a></li>
      <li><a href="#">æµªæµªæ“šé»</a></li>
      <li><a href="#" onclick="goToLogin()">æœƒå“¡ç™»å…¥</a></li>
      <li><a href="#" onclick="goToMember()">æœƒå“¡å°ˆå€</a></li>
      <li><a href="#" id="logout-btn" style="display:none;" onclick="logout()">ç™»å‡º</a></li>
    </ul>
  </nav>
  
  <div class="marquee-container">
  <div class="marquee">ğŸ¾ æ­¡è¿æ”¶é¤Šæµªæµªï¼ä»Šå¤©æœ‰ 5 éš»ç­‰å¾…èªé¤Šä¸­ï½ ğŸ“ æ–°å¢æ–°ç«¹æ“šé» â˜€ï¸ å¤å­£é ˜é¤Šæ´»å‹•é–‹è·‘ï¼</div>
</div>
   <!-- è·‘é¦¬ç‡ˆå€å¡Š -->
 
  <h1>ç›®å‰æœ‰é€™äº›å¯æ„›çš„æµªæµªç­‰å¾…é ˜é¤Šï¼</h1>
   <!-- æœ€æ–°æ¶ˆæ¯å€å¡Šï¼ˆåˆå§‹éš±è—ï¼‰ -->
  <div id="news-section" style="display:none;">
    <h2>ğŸ“¢ æœ€æ–°æ¶ˆæ¯</h2>
    <div id="news-container" class="scroll-container">
      <!-- å‹•æ…‹æ’å…¥ -->
    </div>
  </div>

  <div id="animal-list"></div>

  <script>
  
 async function loadAnimals() {
  const res = await fetch("http://localhost:3000/animals");
  const animals = await res.json();

  const list = document.getElementById("animal-list");
  list.innerHTML = ""; // æ¸…ç©ºåŸæœ¬å…§å®¹
  animals.forEach(a => {
    const item = document.createElement("div");
    item.className = "animal-card";
    item.innerHTML = `
      <img src="http://localhost:3000${a.image_url}" alt="${a.breed}">

      <h3>${a.breed} (${a.type})</h3>
      <p>å¹´é½¡ï¼š${a.age}</p>
      <p>æ€§åˆ¥ï¼š${a.gender}</p>
      <p>æ¯æœˆè²»ç”¨ï¼š${a.monthly_cost}</p>
      <button onclick ="adopt(${a.id},'${a.breed}')">é ˜é¤Šæˆ‘</button>
    `;
    list.appendChild(item);
  });
}

loadAnimals();



    function goToLogin() {
  window.location.href = "login.html";
  }

    function adopt(animalId, breed) {
  // 1. æª¢æŸ¥æ˜¯å¦ç™»å…¥
  if (localStorage.getItem("loggedIn") !== "true") {
    alert("è«‹å…ˆç™»å…¥æ‰èƒ½é ˜é¤Šï¼");
    window.location.href = "login.html";
    return;
  }

  const userId = localStorage.getItem("userId");

  // 2. å‘¼å«å¾Œç«¯ API
  fetch("http://localhost:3000/adopt", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      user_id: userId,
      animal_id: animalId
    })
  })
  .then(res => res.json())
  .then(data => {
    alert(`ä½ å·²æˆåŠŸé ˜é¤Š ${breed}ï¼æ„Ÿè¬ä½ çš„æ„›å¿ƒ ğŸ’–`);

    // 3. å‰ç«¯ç§»é™¤å¡ç‰‡
    document.querySelectorAll(".animal-card").forEach(card => {
      if (card.innerHTML.includes(breed)) {
        card.remove();
      }
    });
  });
}


    function logout() {
      localStorage.removeItem("loggedIn");
      alert("æ‚¨å·²ç™»å‡º");
      window.location.href = "index.html";
    }

    function goToMember() {
      if (localStorage.getItem("loggedIn") === "true") {
        alert("æ­¡è¿é€²å…¥æœƒå“¡å°ˆå€ï¼");
         window.location.href = "member.html";
      } else {
        alert("è«‹å…ˆç™»å…¥æ‰èƒ½é€²å…¥æœƒå“¡å°ˆå€ï¼");
        window.location.href = "login.html";
      }
    }

    // ç™»å‡ºæŒ‰éˆ•é¡¯ç¤ºæ§åˆ¶
    if (localStorage.getItem("loggedIn") === "true") {
      document.getElementById("logout-btn").style.display = "inline-block";
    }
     
      const newsList = [
        "ğŸ¶ æœ¬é€±æœ‰ 5 éš»æ–°æµªæµªç­‰å¾…é ˜é¤Šï¼",
        "ğŸ“ æ–°å¢æ–°ç«¹æµªæµªæ“šé»ï¼Œæ­¡è¿æ¢è¨ªï¼",
        "",
        "âš ï¸ 6 æœˆ 1 æ—¥èµ·é–‹æ”¾ç·šä¸Šé ˜é¤Šé ç´„",
        "â¤ï¸ æ„Ÿè¬å¿—å·¥å€‘é•·æœŸä»˜å‡º"
     ];
      let newsRendered = false;
  function toggleNews() {
  const section = document.getElementById("news-section");
  const container = document.getElementById("news-container");

  if (section.style.display === "none" || section.style.display === "") {
    section.style.display = "block";

    if (!newsRendered) {
      container.innerHTML = ""; // æ¸…ç©ºèˆŠå…§å®¹

      newsList.forEach(msg => {
        const card = document.createElement("div");
        card.className = "news-card";
        card.innerHTML = msg.trim() !== ""
          ? `<p>${msg}</p>`
          : `<p style="color:#aaa; font-style:italic;">ï¼ˆé€™æ˜¯ä¸€å‰‡ç„¡æ–‡å­—çš„æ¶ˆæ¯ï¼‰</p>`;
        container.appendChild(card);
      });

      newsRendered = true;
    }

    window.scrollTo({ top: section.offsetTop - 20, behavior: "smooth" });
  } else {
    section.style.display = "none";
  }
}

  </script>
</body>
</html>
